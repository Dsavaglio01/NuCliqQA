{"version":3,"sources":["ControlBar.tsx"],"names":["React","View","StyleSheet","useRecoilState","editingModeState","imageDataState","processingState","IconButton","useContext","EditorContext","useEffect","usePerformCrop","ControlBar","editingMode","setEditingMode","imageData","processing","setProcessing","mode","onCloseEditor","onEditingComplete","performCrop","shouldDisableDoneButton","onFinishEditing","onPressBack","uri","styles","container","create","width","height","backgroundColor","flexDirection","justifyContent","alignItems","paddingHorizontal"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,IAAT,EAAeC,UAAf,QAAiC,cAAjC;AAEA,SAASC,cAAT,QAA+B,QAA/B;AACA,SAASC,gBAAT,EAA2BC,cAA3B,EAA2CC,eAA3C,QAAkE,SAAlE;AACA,SAASC,UAAT,QAA2B,yBAA3B;AACA,SAASC,UAAT,QAA2B,OAA3B;AACA,SAASC,aAAT,QAA8B,SAA9B;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,SAASC,cAAT,QAA+B,8BAA/B;;AAEA,SAASC,UAAT,GAAsB;AACpB;AACA,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCX,cAAc,CAACC,gBAAD,CAApD;AACA,QAAM,CAACW,SAAD,IAAcZ,cAAc,CAACE,cAAD,CAAlC;AACA,QAAM,CAACW,UAAD,EAAaC,aAAb,IAA8Bd,cAAc,CAACG,eAAD,CAAlD;AACA,QAAM;AAAEY,IAAAA,IAAF;AAAQC,IAAAA,aAAR;AAAuBC,IAAAA;AAAvB,MAA6CZ,UAAU,CAACC,aAAD,CAA7D;AAEA,QAAMY,WAAW,GAAGV,cAAc,EAAlC;AAEA,QAAMW,uBAAuB,GAC3BT,WAAW,KAAK,kBAAhB,IAAsCK,IAAI,KAAK,WADjD;;AAGA,QAAMK,eAAe,GAAG,YAAY;AAClC,QAAIL,IAAI,KAAK,MAAb,EAAqB;AACnBD,MAAAA,aAAa,CAAC,KAAD,CAAb;AACAG,MAAAA,iBAAiB,CAACL,SAAD,CAAjB;AACAI,MAAAA,aAAa;AACd,KAJD,MAIO,IAAID,IAAI,KAAK,WAAb,EAA0B;AAC/B,YAAMG,WAAW,EAAjB;AACD;AACF,GARD;;AAUA,QAAMG,WAAW,GAAG,MAAM;AACxB,QAAIN,IAAI,KAAK,MAAb,EAAqB;AACnB,UAAIL,WAAW,KAAK,kBAApB,EAAwC;AACtCM,QAAAA,aAAa;AACd,OAFD,MAEO;AACLL,QAAAA,cAAc,CAAC,kBAAD,CAAd;AACD;AACF,KAND,MAMO,IAAII,IAAI,KAAK,WAAb,EAA0B;AAC/BC,MAAAA,aAAa;AACd;AACF,GAVD,CAtBoB,CAkCpB;AACA;AACA;;;AACAT,EAAAA,SAAS,CAAC,MAAM;AACd,QACEQ,IAAI,KAAK,WAAT,IACAH,SAAS,CAACU,GADV,IAEAZ,WAAW,KAAK,kBAHlB,EAIE;AACAO,MAAAA,iBAAiB,CAACL,SAAD,CAAjB;AACAI,MAAAA,aAAa;AACd;AACF,GATQ,EASN,CAACJ,SAAD,EAAYF,WAAZ,CATM,CAAT;AAWA,sBACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEa,MAAM,CAACC;AAApB,kBACE,oBAAC,UAAD;AAAY,IAAA,MAAM,EAAC,YAAnB;AAAgC,IAAA,IAAI,EAAC,QAArC;AAA8C,IAAA,OAAO,EAAEH;AAAvD,IADF,eAEE,oBAAC,UAAD;AACE,IAAA,MAAM,EAAC,MADT;AAEE,IAAA,IAAI,EAAC,UAFP;AAGE,IAAA,OAAO,EAAED,eAHX;AAIE,IAAA,QAAQ,EAAED;AAJZ,IAFF,CADF;AAWD;;AAED,SAASV,UAAT;AAEA,MAAMc,MAAM,GAAGxB,UAAU,CAAC0B,MAAX,CAAkB;AAC/BD,EAAAA,SAAS,EAAE;AACTE,IAAAA,KAAK,EAAE,MADE;AAETC,IAAAA,MAAM,EAAE,EAFC;AAGTC,IAAAA,eAAe,EAAE,MAHR;AAITC,IAAAA,aAAa,EAAE,KAJN;AAKTC,IAAAA,cAAc,EAAE,eALP;AAMTC,IAAAA,UAAU,EAAE,QANH;AAOTC,IAAAA,iBAAiB,EAAE;AAPV;AADoB,CAAlB,CAAf","sourcesContent":["import * as React from \"react\";\r\nimport { View, StyleSheet } from \"react-native\";\r\nimport _ from \"lodash\";\r\nimport { useRecoilState } from \"recoil\";\r\nimport { editingModeState, imageDataState, processingState } from \"./Store\";\r\nimport { IconButton } from \"./components/IconButton\";\r\nimport { useContext } from \"react\";\r\nimport { EditorContext } from \"./index\";\r\nimport { useEffect } from \"react\";\r\nimport { usePerformCrop } from \"./customHooks/usePerformCrop\";\r\n\r\nfunction ControlBar() {\r\n  //\r\n  const [editingMode, setEditingMode] = useRecoilState(editingModeState);\r\n  const [imageData] = useRecoilState(imageDataState);\r\n  const [processing, setProcessing] = useRecoilState(processingState);\r\n  const { mode, onCloseEditor, onEditingComplete } = useContext(EditorContext);\r\n\r\n  const performCrop = usePerformCrop();\r\n\r\n  const shouldDisableDoneButton =\r\n    editingMode !== \"operation-select\" && mode !== \"crop-only\";\r\n\r\n  const onFinishEditing = async () => {\r\n    if (mode === \"full\") {\r\n      setProcessing(false);\r\n      onEditingComplete(imageData);\r\n      onCloseEditor();\r\n    } else if (mode === \"crop-only\") {\r\n      await performCrop();\r\n    }\r\n  };\r\n\r\n  const onPressBack = () => {\r\n    if (mode === \"full\") {\r\n      if (editingMode === \"operation-select\") {\r\n        onCloseEditor();\r\n      } else {\r\n        setEditingMode(\"operation-select\");\r\n      }\r\n    } else if (mode === \"crop-only\") {\r\n      onCloseEditor();\r\n    }\r\n  };\r\n\r\n  // Complete the editing process if we are in crop only mode after the editingMode gets set\r\n  // back to operation select (happens internally in usePerformCrop) - can't do it in onFinishEditing\r\n  // else it gets stale state - may need to refactor the hook as this feels hacky\r\n  useEffect(() => {\r\n    if (\r\n      mode === \"crop-only\" &&\r\n      imageData.uri &&\r\n      editingMode === \"operation-select\"\r\n    ) {\r\n      onEditingComplete(imageData);\r\n      onCloseEditor();\r\n    }\r\n  }, [imageData, editingMode]);\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <IconButton iconID=\"arrow-back\" text=\"Retour\" onPress={onPressBack} />\r\n      <IconButton\r\n        iconID=\"done\"\r\n        text=\"Terminer\"\r\n        onPress={onFinishEditing}\r\n        disabled={shouldDisableDoneButton}\r\n      />\r\n    </View>\r\n  );\r\n}\r\n\r\nexport { ControlBar };\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    width: \"100%\",\r\n    height: 80,\r\n    backgroundColor: \"#000\",\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-between\",\r\n    alignItems: \"center\",\r\n    paddingHorizontal: 4,\r\n  },\r\n});\r\n"]}