{"version":3,"sources":["ControlBar.tsx"],"names":["ControlBar","editingMode","setEditingMode","editingModeState","imageData","imageDataState","processing","setProcessing","processingState","mode","onCloseEditor","onEditingComplete","EditorContext","performCrop","shouldDisableDoneButton","onFinishEditing","onPressBack","uri","styles","container","StyleSheet","create","width","height","backgroundColor","flexDirection","justifyContent","alignItems","paddingHorizontal"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;AACA;;AACA;;AAEA;;AAEA;;;;;;AAEA,SAASA,UAAT,GAAsB;AACpB;AACA,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgC,4BAAeC,uBAAf,CAAtC;AACA,QAAM,CAACC,SAAD,IAAc,4BAAeC,qBAAf,CAApB;AACA,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8B,4BAAeC,sBAAf,CAApC;AACA,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,aAAR;AAAuBC,IAAAA;AAAvB,MAA6C,sBAAWC,oBAAX,CAAnD;AAEA,QAAMC,WAAW,GAAG,qCAApB;AAEA,QAAMC,uBAAuB,GAC3Bb,WAAW,KAAK,kBAAhB,IAAsCQ,IAAI,KAAK,WADjD;;AAGA,QAAMM,eAAe,GAAG,YAAY;AAClC,QAAIN,IAAI,KAAK,MAAb,EAAqB;AACnBF,MAAAA,aAAa,CAAC,KAAD,CAAb;AACAI,MAAAA,iBAAiB,CAACP,SAAD,CAAjB;AACAM,MAAAA,aAAa;AACd,KAJD,MAIO,IAAID,IAAI,KAAK,WAAb,EAA0B;AAC/B,YAAMI,WAAW,EAAjB;AACD;AACF,GARD;;AAUA,QAAMG,WAAW,GAAG,MAAM;AACxB,QAAIP,IAAI,KAAK,MAAb,EAAqB;AACnB,UAAIR,WAAW,KAAK,kBAApB,EAAwC;AACtCS,QAAAA,aAAa;AACd,OAFD,MAEO;AACLR,QAAAA,cAAc,CAAC,kBAAD,CAAd;AACD;AACF,KAND,MAMO,IAAIO,IAAI,KAAK,WAAb,EAA0B;AAC/BC,MAAAA,aAAa;AACd;AACF,GAVD,CAtBoB,CAkCpB;AACA;AACA;;;AACA,uBAAU,MAAM;AACd,QACED,IAAI,KAAK,WAAT,IACAL,SAAS,CAACa,GADV,IAEAhB,WAAW,KAAK,kBAHlB,EAIE;AACAU,MAAAA,iBAAiB,CAACP,SAAD,CAAjB;AACAM,MAAAA,aAAa;AACd;AACF,GATD,EASG,CAACN,SAAD,EAAYH,WAAZ,CATH;AAWA,sBACE,oBAAC,iBAAD;AAAM,IAAA,KAAK,EAAEiB,MAAM,CAACC;AAApB,kBACE,oBAAC,sBAAD;AAAY,IAAA,MAAM,EAAC,YAAnB;AAAgC,IAAA,IAAI,EAAC,QAArC;AAA8C,IAAA,OAAO,EAAEH;AAAvD,IADF,eAEE,oBAAC,sBAAD;AACE,IAAA,MAAM,EAAC,MADT;AAEE,IAAA,IAAI,EAAC,UAFP;AAGE,IAAA,OAAO,EAAED,eAHX;AAIE,IAAA,QAAQ,EAAED;AAJZ,IAFF,CADF;AAWD;;AAID,MAAMI,MAAM,GAAGE,wBAAWC,MAAX,CAAkB;AAC/BF,EAAAA,SAAS,EAAE;AACTG,IAAAA,KAAK,EAAE,MADE;AAETC,IAAAA,MAAM,EAAE,EAFC;AAGTC,IAAAA,eAAe,EAAE,MAHR;AAITC,IAAAA,aAAa,EAAE,KAJN;AAKTC,IAAAA,cAAc,EAAE,eALP;AAMTC,IAAAA,UAAU,EAAE,QANH;AAOTC,IAAAA,iBAAiB,EAAE;AAPV;AADoB,CAAlB,CAAf","sourcesContent":["import * as React from \"react\";\r\nimport { View, StyleSheet } from \"react-native\";\r\nimport _ from \"lodash\";\r\nimport { useRecoilState } from \"recoil\";\r\nimport { editingModeState, imageDataState, processingState } from \"./Store\";\r\nimport { IconButton } from \"./components/IconButton\";\r\nimport { useContext } from \"react\";\r\nimport { EditorContext } from \"./index\";\r\nimport { useEffect } from \"react\";\r\nimport { usePerformCrop } from \"./customHooks/usePerformCrop\";\r\n\r\nfunction ControlBar() {\r\n  //\r\n  const [editingMode, setEditingMode] = useRecoilState(editingModeState);\r\n  const [imageData] = useRecoilState(imageDataState);\r\n  const [processing, setProcessing] = useRecoilState(processingState);\r\n  const { mode, onCloseEditor, onEditingComplete } = useContext(EditorContext);\r\n\r\n  const performCrop = usePerformCrop();\r\n\r\n  const shouldDisableDoneButton =\r\n    editingMode !== \"operation-select\" && mode !== \"crop-only\";\r\n\r\n  const onFinishEditing = async () => {\r\n    if (mode === \"full\") {\r\n      setProcessing(false);\r\n      onEditingComplete(imageData);\r\n      onCloseEditor();\r\n    } else if (mode === \"crop-only\") {\r\n      await performCrop();\r\n    }\r\n  };\r\n\r\n  const onPressBack = () => {\r\n    if (mode === \"full\") {\r\n      if (editingMode === \"operation-select\") {\r\n        onCloseEditor();\r\n      } else {\r\n        setEditingMode(\"operation-select\");\r\n      }\r\n    } else if (mode === \"crop-only\") {\r\n      onCloseEditor();\r\n    }\r\n  };\r\n\r\n  // Complete the editing process if we are in crop only mode after the editingMode gets set\r\n  // back to operation select (happens internally in usePerformCrop) - can't do it in onFinishEditing\r\n  // else it gets stale state - may need to refactor the hook as this feels hacky\r\n  useEffect(() => {\r\n    if (\r\n      mode === \"crop-only\" &&\r\n      imageData.uri &&\r\n      editingMode === \"operation-select\"\r\n    ) {\r\n      onEditingComplete(imageData);\r\n      onCloseEditor();\r\n    }\r\n  }, [imageData, editingMode]);\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <IconButton iconID=\"arrow-back\" text=\"Retour\" onPress={onPressBack} />\r\n      <IconButton\r\n        iconID=\"done\"\r\n        text=\"Terminer\"\r\n        onPress={onFinishEditing}\r\n        disabled={shouldDisableDoneButton}\r\n      />\r\n    </View>\r\n  );\r\n}\r\n\r\nexport { ControlBar };\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    width: \"100%\",\r\n    height: 80,\r\n    backgroundColor: \"#000\",\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-between\",\r\n    alignItems: \"center\",\r\n    paddingHorizontal: 4,\r\n  },\r\n});\r\n"]}